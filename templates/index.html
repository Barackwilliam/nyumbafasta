{% extends 'base.html' %}
{% load static %}

{% block title %}Home - NyumbaFasta{% endblock %}

{% block extra_css %}
<style>
    :root {
        --blue-gradient: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
        --yellow-gradient: linear-gradient(135deg, #ffd60a 0%, #ffc300 100%);
        --blue-yellow-gradient: linear-gradient(135deg, #4361ee 0%, #ffd60a 100%);
        --dark-blue-gradient: linear-gradient(135deg, #2c3e50 0%, #4361ee 100%);
        --light-bg: #f8f9fa;
    }
    
    /* Hero Section */
    .hero-section {
        background: linear-gradient(rgba(0, 0, 0, 0.9), rgba(67, 97, 238, 0.2)), 
                    url('https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        padding: 100px 0 40px;
        color: white;
        position: relative;
        overflow: hidden;
        margin-top: -20px;
    }
    
    .hero-section::before {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        right: 0;
        height: 80px;
        background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%23ffffff' fill-opacity='1' d='M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E");
        background-size: cover;
        background-repeat: no-repeat;
    }
    
    .hero-title {
        font-size: 2.5rem;
        font-weight: 800;
        background: var(--yellow-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1rem;
        line-height: 1.2;
        text-shadow: 0 2px 20px rgba(255, 214, 10, 0.3);
    }
    
    .hero-subtitle {
        font-size: 1rem;
        color: rgba(255, 255, 255, 0.9);
        margin-bottom: 1.5rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
    }
    
    /* Search Card */
    .search-card {
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        border-radius: 15px;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        padding: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        position: relative;
        z-index: 1;
        margin-bottom: 20px;
    }
    
    /* Featured Properties Section */
    .featured-section {
        background: var(--light-bg);
        padding: 40px 0;
    }
    
    .featured-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding: 0 15px;
    }
    
    .featured-title {
        font-size: 1.8rem;
        font-weight: 700;
        color: #2c3e50;
        position: relative;
        padding-left: 15px;
    }
    
    .featured-title::before {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 5px;
        height: 30px;
        background: var(--blue-gradient);
        border-radius: 3px;
    }
    
    /* Featured Properties Grid */
    .featured-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 25px;
        padding: 0 15px;
    }
    
    .featured-property-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        cursor: pointer;
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    
    .featured-property-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
    }
    
    .featured-image-container {
        position: relative;
        height: 200px;
        overflow: hidden;
    }
    
    .featured-image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }
    
    .featured-property-card:hover .featured-image-container img {
        transform: scale(1.05);
    }
    
    /* Featured Properties Badges - Updated */
    .featured-badges {
        position: absolute;
        top: 15px;
        left: 15px;
        right: 15px;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        z-index: 2;
    }
    
    .featured-badge-left {
        background: var(--blue-gradient);
        color: white;
        padding: 6px 15px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        letter-spacing: 0.5px;
        box-shadow: 0 3px 10px rgba(67, 97, 238, 0.3);
    }
    
    .featured-badge-right {
        background: linear-gradient(135deg, #ff6b35 0%, #ff4d00 100%);
        color: white;
        padding: 6px 15px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        letter-spacing: 0.5px;
        box-shadow: 0 3px 10px rgba(255, 107, 53, 0.3);
    }
    
    .verified-badge-container {
        position: absolute;
        bottom: 15px;
        left: 15px;
        z-index: 2;
    }
    
    .verified-badge {
        display: flex;
        align-items: center;
        gap: 6px;
        background: white;
        padding: 6px 12px;
        border-radius: 20px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
    }
    
    .verified-tick {
        color: #ff0000; /* Red color */
        font-weight: bold;
        font-size: 1rem;
    }
    
    .verified-text {
        color: #ff0000; /* Red color */
        font-size: 0.75rem;
        font-weight: 600;
    }
    
    .featured-price-tag {
        position: absolute;
        bottom: 15px;
        right: 15px;
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 15px;
        border-radius: 25px;
        font-weight: 700;
        font-size: 1.1rem;
        color: #ff6b35;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        z-index: 2;
    }
    
    .featured-content {
        padding: 20px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
    }
    
    .featured-content h4 {
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 10px;
        color: #2c3e50;
        line-height: 1.4;
    }
    
    .featured-location {
        color: #4361ee;
        font-size: 0.85rem;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 6px;
    }
    
    .featured-description {
        color: #666;
        font-size: 0.9rem;
        line-height: 1.5;
        margin-bottom: 15px;
        flex-grow: 1;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .featured-features {
        display: flex;
        gap: 15px;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #eee;
    }
    
    .featured-feature {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 0.8rem;
        color: #666;
    }
    
    .featured-feature i {
        color: #4361ee;
        font-size: 0.9rem;
    }
    
    .featured-action {
        margin-top: 15px;
    }
    
    .view-details-btn {
        background: var(--blue-gradient);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.9rem;
        width: 100%;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }
    
    .view-details-btn:hover {
        background: linear-gradient(135deg, #3a56d4 0%, #4361ee 100%);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
    }
    
    /* Image Placeholder */
    .featured-image-placeholder {
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        padding: 20px;
    }
    
    .featured-image-placeholder i {
        font-size: 3rem;
        margin-bottom: 10px;
        opacity: 0.8;
    }
    
    /* Latest Listings */
    .latest-section {
        padding: 40px 0;
    }
    
    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding: 0 15px;
    }
    
    .section-title {
        font-size: 1.8rem;
        font-weight: 700;
        color: #2c3e50;
        position: relative;
        padding-left: 15px;
    }
    
    .section-title::before {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 5px;
        height: 30px;
        background: var(--blue-gradient);
        border-radius: 3px;
    }
    
    /* Property Cards */
    .property-card {
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
        height: 100%;
        cursor: pointer;
    }
    
    .property-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    
    .property-image {
        position: relative;
        height: 180px;
        overflow: hidden;
    }
    
    .property-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }
    
    .property-card:hover .property-image img {
        transform: scale(1.05);
    }
    
    .property-content {
        padding: 20px;
    }
    
    .property-price {
        color: #ff6b35;
        font-weight: 700;
        font-size: 1.2rem;
        margin-bottom: 8px;
    }
    
    .property-title {
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 8px;
        color: #2c3e50;
    }
    
    .property-location {
        color: #666;
        font-size: 0.85rem;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .property-description {
        color: #777;
        font-size: 0.85rem;
        line-height: 1.4;
        margin-bottom: 15px;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .property-features {
        display: flex;
        gap: 12px;
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid #eee;
    }
    
    /* Region Select */
    .region-select-container {
        position: relative;
    }
    
    .region-select-container .input-group-text {
        background: var(--blue-gradient);
        color: white;
        border: none;
        border-radius: 10px 0 0 10px;
        padding-left: 15px;
    }
    
    .region-select-container .form-control {
        border: 2px solid #e9ecef;
        border-left: none;
        border-radius: 0 10px 10px 0;
        transition: all 0.3s ease;
        height: 50px;
        padding: 0.75rem 1rem;
        font-size: 0.95rem;
    }
    
    .region-select-container .form-control:focus {
        border-color: #ffd60a;
        box-shadow: 0 0 0 3px rgba(255, 214, 10, 0.2);
        outline: none;
    }
    
    /* Region Dropdown */
    .region-dropdown {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border-radius: 10px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        border: 2px solid #4361ee;
        z-index: 1050;
        max-height: 350px;
        overflow-y: auto;
        display: none;
        margin-top: 5px;
    }
    
    .region-dropdown.show {
        display: block;
        animation: slideDown 0.3s ease;
    }
    
    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .region-group {
        padding: 8px 0;
        border-bottom: 1px solid #e9ecef;
    }
    
    .region-group:last-child {
        border-bottom: none;
    }
    
    .region-header {
        padding: 10px 15px;
        background: #f8f9fa;
        color: #4361ee;
        font-weight: 600;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        border-left: 3px solid #ffd60a;
    }
    
    .region-option {
        padding: 10px 15px;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        color: #333;
        text-decoration: none;
        font-size: 0.9rem;
    }
    
    .region-option:hover {
        background: rgba(67, 97, 238, 0.1);
        padding-left: 20px;
        color: #333;
        text-decoration: none;
    }
    
    .region-option.selected {
        background: var(--blue-gradient);
        color: white;
    }
    
    .region-option .flag {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: linear-gradient(45deg, #4361ee, #ffd60a);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.6rem;
        color: white;
        font-weight: bold;
    }
    
    /* Buttons */
    .btn-yellow {
        background: var(--yellow-gradient);
        color: #4361ee;
        font-weight: 600;
        border: none;
        padding: 10px 25px;
        border-radius: 8px;
        transition: all 0.3s ease;
        font-size: 0.9rem;
    }
    
    .btn-yellow:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(255, 214, 10, 0.3);
        color: #4361ee;
    }
    
    .btn-blue {
        background: var(--blue-gradient);
        color: white;
        border: none;
        font-weight: 600;
        padding: 10px 25px;
        border-radius: 8px;
        transition: all 0.3s ease;
        font-size: 0.9rem;
    }
    
    .btn-blue:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(67, 97, 238, 0.3);
        color: white;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
        .hero-section {
            padding: 80px 0 30px;
            background-attachment: scroll;
        }
        
        .hero-title {
            font-size: 1.8rem;
        }
        
        .hero-subtitle {
            font-size: 0.9rem;
        }
        
        .search-card {
            padding: 1.2rem;
            margin: 0 10px;
        }
        
        .featured-grid {
            grid-template-columns: 1fr;
            padding: 0 10px;
        }
        
        .featured-header {
            padding: 0 10px;
        }
        
        .section-header {
            padding: 0 10px;
        }
        
        .featured-title,
        .section-title {
            font-size: 1.5rem;
        }
        
        .featured-image-container {
            height: 180px;
        }
    }
    
    @media (min-width: 768px) and (max-width: 992px) {
        .featured-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    
    @media (min-width: 992px) {
        .featured-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }
    
    /* Custom Scrollbar */
    .region-dropdown::-webkit-scrollbar {
        width: 6px;
    }
    
    .region-dropdown::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 3px;
    }
    
    .region-dropdown::-webkit-scrollbar-thumb {
        background: #4361ee;
        border-radius: 3px;
    }
    
    .region-dropdown::-webkit-scrollbar-thumb:hover {
        background: #3a56d4;
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container position-relative">
        <div class="row justify-content-center">
            <div class="col-lg-10 text-center">
                <h1 class="hero-title mb-4">Find Your Dream Home Today!</h1>
                <p class="hero-subtitle mb-5">We collect the best properties from Facebook and various sources. Affordable prices, great locations, and secure housing solutions.</p>
                
                <!-- Advanced Search -->
                <div class="search-card">
                    <form action="{% url 'makazi:listings' %}" method="get" class="row g-3" id="searchForm">
                        <!-- Region Select -->
                        <div class="col-lg-4">
                            <div class="region-select-container">
                                <div class="input-group input-group-lg">
                                    <span class="input-group-text">
                                        <i class="bi bi-geo-alt fs-5"></i>
                                    </span>
                                    <input type="text" 
                                           class="form-control" 
                                           name="location" 
                                           placeholder="Choose region..."
                                           id="regionInput"
                                           autocomplete="off"
                                           style="background: var(--light-bg);">
                                </div>
                                
                                <!-- Region Dropdown -->
                                <div class="region-dropdown" id="regionDropdown">
                                    <!-- Mainland Regions -->
                                    <div class="region-group">
                                        <div class="region-header">Mainland Regions</div>
                                        <div class="region-option" data-value="Dar es Salaam">
                                            <span class="flag">DSM</span>
                                            Dar es Salaam
                                        </div>
                                        <div class="region-option" data-value="Arusha">
                                            <span class="flag">AR</span>
                                            Arusha
                                        </div>
                                        <div class="region-option" data-value="Mwanza">
                                            <span class="flag">MW</span>
                                            Mwanza
                                        </div>
                                        <div class="region-option" data-value="Mbeya">
                                            <span class="flag">MB</span>
                                            Mbeya
                                        </div>
                                        <div class="region-option" data-value="Dodoma">
                                            <span class="flag">DD</span>
                                            Dodoma
                                        </div>
                                        <div class="region-option" data-value="Tanga">
                                            <span class="flag">TN</span>
                                            Tanga
                                        </div>
                                        <div class="region-option" data-value="Morogoro">
                                            <span class="flag">MO</span>
                                            Morogoro
                                        </div>
                                        <div class="region-option" data-value="Moshi">
                                            <span class="flag">MS</span>
                                            Moshi
                                        </div>
                                        <div class="region-option" data-value="Tabora">
                                            <span class="flag">TB</span>
                                            Tabora
                                        </div>
                                        <div class="region-option" data-value="Singida">
                                            <span class="flag">SI</span>
                                            Singida
                                        </div>
                                        <div class="region-option" data-value="Shinyanga">
                                            <span class="flag">SH</span>
                                            Shinyanga
                                        </div>
                                        <div class="region-option" data-value="Iringa">
                                            <span class="flag">IR</span>
                                            Iringa
                                        </div>
                                        <div class="region-option" data-value="Songwe">
                                            <span class="flag">SO</span>
                                            Songwe
                                        </div>
                                        <div class="region-option" data-value="Kagera">
                                            <span class="flag">KG</span>
                                            Kagera
                                        </div>
                                        <div class="region-option" data-value="Mtwara">
                                            <span class="flag">MT</span>
                                            Mtwara
                                        </div>
                                        <div class="region-option" data-value="Lindi">
                                            <span class="flag">LI</span>
                                            Lindi
                                        </div>
                                        <div class="region-option" data-value="Ruvuma">
                                            <span class="flag">RV</span>
                                            Ruvuma
                                        </div>
                                        <div class="region-option" data-value="Kigoma">
                                            <span class="flag">KI</span>
                                            Kigoma
                                        </div>
                                        <div class="region-option" data-value="Pwani">
                                            <span class="flag">PW</span>
                                            Pwani (Coast)
                                        </div>
                                        <div class="region-option" data-value="Rukwa">
                                            <span class="flag">RK</span>
                                            Rukwa
                                        </div>
                                        <div class="region-option" data-value="Manyara">
                                            <span class="flag">MY</span>
                                            Manyara
                                        </div>
                                        <div class="region-option" data-value="Geita">
                                            <span class="flag">GT</span>
                                            Geita
                                        </div>
                                        <div class="region-option" data-value="Katavi">
                                            <span class="flag">KT</span>
                                            Katavi
                                        </div>
                                        <div class="region-option" data-value="Njombe">
                                            <span class="flag">NJ</span>
                                            Njombe
                                        </div>
                                        <div class="region-option" data-value="Simiyu">
                                            <span class="flag">SM</span>
                                            Simiyu
                                        </div>
                                    </div>
                                    
                                    <!-- Zanzibar Regions -->
                                    <div class="region-group">
                                        <div class="region-header">Zanzibar Regions</div>
                                        <div class="region-option" data-value="Zanzibar Urban">
                                            <span class="flag">ZU</span>
                                            Zanzibar Urban
                                        </div>
                                        <div class="region-option" data-value="Zanzibar West">
                                            <span class="flag">ZW</span>
                                            Zanzibar West
                                        </div>
                                        <div class="region-option" data-value="Zanzibar North">
                                            <span class="flag">ZN</span>
                                            Zanzibar North
                                        </div>
                                        <div class="region-option" data-value="Zanzibar South">
                                            <span class="flag">ZS</span>
                                            Zanzibar South
                                        </div>
                                        <div class="region-option" data-value="Pemba North">
                                            <span class="flag">PN</span>
                                            Pemba North
                                        </div>
                                        <div class="region-option" data-value="Pemba South">
                                            <span class="flag">PS</span>
                                            Pemba South
                                        </div>
                                    </div>
                                    
                                    <!-- Major Cities -->
                                    <div class="region-group">
                                        <div class="region-header">Major Cities</div>
                                        <div class="region-option" data-value="Dar es Salaam City">
                                            <span class="flag">DC</span>
                                            Dar es Salaam City
                                        </div>
                                        <div class="region-option" data-value="Arusha City">
                                            <span class="flag">AC</span>
                                            Arusha City
                                        </div>
                                        <div class="region-option" data-value="Mwanza City">
                                            <span class="flag">MC</span>
                                            Mwanza City
                                        </div>
                                        <div class="region-option" data-value="Mbeya City">
                                            <span class="flag">MB</span>
                                            Mbeya City
                                        </div>
                                        <div class="region-option" data-value="Dodoma City">
                                            <span class="flag">DC</span>
                                            Dodoma City
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Property Type -->
                        <div class="col-lg-3">
                            <select class="form-select border-0 h-100" name="property_type" id="propertyType" style="background: var(--light-bg);">
                                <option value="">Property Type</option>
                                <option value="house">House</option>
                                <option value="apartment">Apartment</option>
                                <option value="room">Room</option>
                                <option value="plot">Plot</option>
                            </select>
                        </div>
                        
                        <!-- Bedrooms -->
                        <div class="col-lg-3">
                            <select class="form-select border-0 h-100" name="bedrooms" id="bedrooms" style="background: var(--light-bg);">
                                <option value="">Bedrooms</option>
                                <option value="1">1 Bedroom</option>
                                <option value="2">2 Bedrooms</option>
                                <option value="3">3 Bedrooms</option>
                                <option value="4">4+ Bedrooms</option>
                            </select>
                        </div>
                        
                        <!-- Search Button -->
                        <div class="col-lg-2">
                            <button type="submit" class="btn btn-yellow btn-lg w-100 h-100">
                                <i class="bi bi-search me-2"></i>Search
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Properties -->
<section class="featured-section">
    <div class="container">
        <div class="featured-header">
            <h2 class="featured-title">Featured Properties</h2>
            <a href="{% url 'makazi:listings' %}?is_featured=true" class="btn btn-blue">
                View All Featured <i class="bi bi-arrow-right ms-2"></i>
            </a>
        </div>
        
        <div class="featured-grid">
            {% for listing in featured_listings %}
            <div class="featured-property-card" onclick="window.location.href='{{ listing.get_absolute_url }}'" style="cursor: pointer;">
                <div class="featured-image-container">
                    {% if listing.main_image_url %}
                        <img src="{{ listing.main_image_url }}" 
                             alt="{{ listing.title }}"
                             loading="lazy">
                    {% else %}
                        <div class="featured-image-placeholder">
                            <i class="bi bi-house"></i>
                            <small>No Image Available</small>
                        </div>
                    {% endif %}
                    
                    <!-- Featured and New Badges -->
                    <div class="featured-badges">
                        <div class="featured-badge-left">FEATURED</div>
                        {% if listing.scraped_at|date:"U" > now|date:"U"|add:"-259200" %}
                        <div class="featured-badge-right">NEW</div>
                        {% endif %}
                    </div>
                    
                    <!-- Verified Badge (tick symbol in red) -->
                    {% if listing.is_verified %}
                    <div class="verified-badge-container">
                        <div class="verified-badge">
                            <span class="verified-tick">âœ“</span>
                            <span class="verified-text">VERIFIED</span>
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- Price Tag -->
                    <div class="featured-price-tag">
                        {% if listing.price %}
                            {{ listing.price }}
                        {% else %}
                            Price on Request
                        {% endif %}
                    </div>
                </div>
                
                <div class="featured-content">
                    <h4>{{ listing.title|truncatechars:60 }}</h4>
                    
                    <div class="featured-location">
                        <i class="bi bi-geo-alt-fill"></i>
                        <span>{{ listing.location|truncatechars:40 }}</span>
                    </div>
                    
                    <div class="featured-features">
                        {% if listing.bedrooms %}
                        <div class="featured-feature">
                            <i class="bi bi-door-closed-fill"></i>
                            <span>{{ listing.bedrooms }} Bed</span>
                        </div>
                        {% endif %}
                        
                        {% if listing.bathrooms %}
                        <div class="featured-feature">
                            <i class="bi bi-droplet-fill"></i>
                            <span>{{ listing.bathrooms }} Bath</span>
                        </div>
                        {% endif %}
                        
                        {% if listing.area_sqft %}
                        <div class="featured-feature">
                            <i class="bi bi-arrows-fullscreen"></i>
                            <span>{{ listing.area_sqft }} sqft</span>
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="featured-action">
                        <button class="view-details-btn">
                            <i class="bi bi-eye-fill"></i> View Full Details
                        </button>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center py-5">
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>No featured properties available at the moment.
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Latest Listings -->
<section class="latest-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Recently Added Properties</h2>
            <a href="{% url 'makazi:listings' %}" class="btn btn-blue">
                View All <i class="bi bi-arrow-right ms-2"></i>
            </a>
        </div>
        
        <div class="row">
            {% for listing in latest_listings %}
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="property-card" onclick="window.location.href='{{ listing.get_absolute_url }}'">
                    <div class="property-image">
                        {% if listing.main_image_url %}
                            <img src="{{ listing.main_image_url }}" 
                                 alt="{{ listing.title }}"
                                 loading="lazy">
                        {% else %}
                            <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%); 
                                 display: flex; align-items: center; justify-content: center; color: white;">
                                <i class="bi bi-house fs-2"></i>
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="property-content">
                        <div class="property-price">
                            {% if listing.price %}
                                {{ listing.price }}
                            {% else %}
                                Price on Request
                            {% endif %}
                        </div>
                        
                        <h5 class="property-title">{{ listing.title|truncatechars:50 }}</h5>
                        
                        <div class="property-location">
                            <i class="bi bi-geo-alt"></i>
                            <span>{{ listing.location|truncatechars:30 }}</span>
                        </div>
                        
                        <div class="property-features">
                            {% if listing.bedrooms %}
                            <small class="text-muted">
                                <i class="bi bi-door-closed text-blue"></i> {{ listing.bedrooms }} Bed
                            </small>
                            {% endif %}
                            
                            {% if listing.bathrooms %}
                            <small class="text-muted">
                                <i class="bi bi-droplet text-blue"></i> {{ listing.bathrooms }} Bath
                            </small>
                            {% endif %}
                            
                            {% if listing.property_type %}
                            <small class="text-muted">
                                <i class="bi bi-tag text-blue"></i> {{ listing.property_type|title }}
                            </small>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center py-5">
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>No properties available at the moment. Please check back later.
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Call to Action -->
<section class="py-5" style="background: var(--dark-blue-gradient);">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-8">
                <h2 class="fw-bold mb-4 text-white">Have a Property to Sell or Rent?</h2>
                <p class="lead mb-5 text-white opacity-90">Contact us today and list your property to reach thousands of potential buyers or tenants</p>
                <a href="{% url 'makazi:contact' %}" class="btn btn-yellow btn-lg px-5 py-3 fw-bold">
                    <i class="bi bi-whatsapp me-2"></i>Contact Us Now
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const regionInput = document.getElementById('regionInput');
        const regionDropdown = document.getElementById('regionDropdown');
        const regionOptions = document.querySelectorAll('.region-option');
        const searchForm = document.getElementById('searchForm');
        
        // Toggle dropdown when clicking input
        regionInput.addEventListener('focus', function() {
            regionDropdown.classList.add('show');
        });
        
        regionInput.addEventListener('click', function(e) {
            e.stopPropagation();
            regionDropdown.classList.add('show');
        });
        
        // Handle option selection
        regionOptions.forEach(option => {
            option.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const value = this.getAttribute('data-value');
                
                // Update input value
                regionInput.value = value;
                
                // Update selected state
                regionOptions.forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                
                // Close dropdown
                regionDropdown.classList.remove('show');
            });
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!regionInput.contains(e.target) && !regionDropdown.contains(e.target)) {
                regionDropdown.classList.remove('show');
            }
        });
        
        // Add search functionality
        regionInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            
            if (searchTerm) {
                regionDropdown.classList.add('show');
                
                regionOptions.forEach(option => {
                    const text = option.textContent.toLowerCase();
                    if (text.includes(searchTerm)) {
                        option.style.display = 'flex';
                        option.parentElement.style.display = 'block';
                    } else {
                        option.style.display = 'none';
                    }
                });
                
                // Show/hide region groups
                document.querySelectorAll('.region-group').forEach(group => {
                    const options = group.querySelectorAll('.region-option');
                    const visibleOptions = Array.from(options).filter(opt => 
                        opt.style.display !== 'none'
                    );
                    
                    if (visibleOptions.length > 0) {
                        group.style.display = 'block';
                    } else {
                        group.style.display = 'none';
                    }
                });
            } else {
                // Show all options if search is empty
                regionOptions.forEach(option => {
                    option.style.display = 'flex';
                });
                
                document.querySelectorAll('.region-group').forEach(group => {
                    group.style.display = 'block';
                });
            }
        });
        
        // Keyboard navigation
        regionInput.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                regionDropdown.classList.remove('show');
            }
            
            if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
                e.preventDefault();
                const visibleOptions = Array.from(regionOptions).filter(opt => 
                    opt.style.display !== 'none'
                );
                
                if (visibleOptions.length > 0) {
                    const currentIndex = visibleOptions.findIndex(opt => 
                        opt.classList.contains('selected')
                    );
                    
                    let nextIndex;
                    if (e.key === 'ArrowDown') {
                        nextIndex = (currentIndex + 1) % visibleOptions.length;
                    } else {
                        nextIndex = (currentIndex - 1 + visibleOptions.length) % visibleOptions.length;
                    }
                    
                    regionOptions.forEach(opt => opt.classList.remove('selected'));
                    visibleOptions[nextIndex].classList.add('selected');
                    regionInput.value = visibleOptions[nextIndex].getAttribute('data-value');
                }
            }
            
            if (e.key === 'Enter' && regionDropdown.classList.contains('show')) {
                e.preventDefault();
                const selectedOption = document.querySelector('.region-option.selected');
                if (selectedOption) {
                    selectedOption.click();
                }
            }
        });
        
        // Make property cards clickable
        document.querySelectorAll('.featured-property-card, .property-card').forEach(card => {
            card.addEventListener('click', function(e) {
                if (!e.target.classList.contains('view-details-btn') && 
                    e.target.tagName !== 'BUTTON' && 
                    e.target.tagName !== 'A') {
                    window.location.href = this.getAttribute('onclick')?.match(/'(.*?)'/)?.[1] || 
                                         this.querySelector('a')?.href || 
                                         '#';
                }
            });
        });
        
        // Handle image errors
        document.querySelectorAll('img').forEach(img => {
            img.addEventListener('error', function() {
                const parent = this.parentElement;
                if (parent.classList.contains('featured-image-container')) {
                    const placeholder = document.createElement('div');
                    placeholder.className = 'featured-image-placeholder';
                    placeholder.innerHTML = '<i class="bi bi-house"></i><small>No Image Available</small>';
                    parent.replaceChild(placeholder, this);
                } else {
                    const placeholder = document.createElement('div');
                    placeholder.style.cssText = 'width: 100%; height: 100%; background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%); display: flex; align-items: center; justify-content: center; color: white;';
                    placeholder.innerHTML = '<i class="bi bi-house fs-2"></i>';
                    parent.replaceChild(placeholder, this);
                }
            });
        });
    });
</script>
{% endblock %}